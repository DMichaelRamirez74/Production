@model FingerprintsModel.CaseNoteByClientID


<style type="text/css">
    .tagsinput {
        width: auto !important;
        height: auto !important;
        min-height: auto !important;
    }

    #divCaseNoteSection .txt-main-note p {
        padding-left: 15px;
    }

    .fa-checkbox.all-notes-check label {
        display: inline-block;
        vertical-align: middle;
        position: relative;
        padding-left: 22px;
        color: #163b69;
        font-size: 15px;
        font-weight: bold;
    }


    .fa-checkbox.all-notes-check input[type="checkbox"]:checked + label:before {
        color: #3FC593;
        width: 14px;
        height: 14px;
        content: '';
        position: absolute;
        top: 3px;
        left: 0;
        /* background-image: url(../../Images/checked.png); */
        content: "\f14a";
        font: normal normal normal 16px/1 FontAwesome;
    }

    .fa-checkbox.all-notes-check input[type="checkbox"] + label:before {
        position: absolute;
        top: 3px;
        width: 14px;
        height: 14px;
        left: 0;
        /* background-image: url(../../Images/check.png); */
        content: "\f096";
        color: #333;
        margin-right: 10px;
        font: normal normal normal 16px/1 FontAwesome;
    }

    #divCaseNoteSection .form-group {
        margin-bottom: 15px !important;
    }

    #divCaseNoteSection .addapplicant {
        font-size: 20px;
        font-weight: bold;
        border-bottom: 2px solid #295b8f;
        color: #295b8f;
        margin: 0 15px;
        margin-bottom: 10px;
    }

    #divCaseNoteSection .transition-content-desc p {
        padding: 10px 10px;
        color: #163b69;
        text-align: left;
        font-size: 15px;
        margin: 0;
        text-transform: none;
        width: 100%;
        float: left;
    }

    #divCaseNoteSection .m-tp {
        margin-bottom: 5px;
    }

    #divCaseNoteSection .no-padding {
        padding: 0;
    }

    .response-addicspace {
        top: 4px;
    }

    .error-notify {
        color: red;
        margin-left: 5px;
    }

    #divCaseNoteSection .img-camera {
        margin-left: 20px !important;
    }


        .accordion {
        position: relative;
        background-color: #e3ebf9;
        display: inline-block;
        width: 100%;
        font-weight: 700;
        color: #41454e;
        vertical-align: middle;
        padding-bottom: 1px;
        border-bottom: 1px solid #fff;
    }

        .accordion:first-child, .accordion:last-child {
            border-radius: 5px 5px 0 0;
        }

        .accordion .fa {
            position: relative;
            float: right;
        }

        .accordion h4 {
            position: relative;
            top: 0.8em;
            margin: 0;
            font-size: 14px;
            font-weight: 700;
        }

        .accordion a {
            position: relative;
            display: block;
            color: #41454e;
            padding: 1em 1em 2.5em 1em;
            text-decoration: none;
        }

        .accordion.active a {
            color: #fff;
        }

        .accordion:last-child {
            border-bottom: unset;
        }


        .accordion:hover {
            text-decoration: none;
            background-color: #41454e;
            color: #fff;
            transition: 0.3s;
        }

    .accordion-desc {
        background-color: #fff;
        color: #74777b;
        z-index: 2;
        padding: 20px 15px;
        border-bottom: 1px solid #3e4770;
        border-left: 1px solid #3e4770;
        border-right: 1px solid #3e4770;
        border-color: #3e4770;
    }

    .accordion h4:after {
        content: '\002B';
        color: #41454e;
        font-weight: bold;
        float: right;
        margin-left: 5px;
    }

    .accordion:hover {
        background-color: #bfc4cd;
        color: #fff;
        padding-left: 25px;
    }


    .accordion.active {
        background-color: #3e4770;
        color: #fff;
        padding-left: 25px;
        border-bottom: unset;
    }

        .accordion.active h4:after {
            content: "\2212";
            color: #fff;
            font-weight: bold;
            float: right;
            margin-left: 5px;
        }

    @@media only screen and (max-width: 760px), (min-device-width: 768px) and (max-device-width: 1200px) {


        #inkind-table, #inkind-table thead, #inkind-table tbody, #inkind-table th, #inkind-table td, #inkind-table tr {
            display: block;
            border: none;
        }

        #inkind-table {
            float: left;
            width: 100%;
        }

            #inkind-table tbody tr td:first-child a {
                width: initial !important;
                text-overflow: initial !important;
            }

            #inkind-table thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }

            #inkind-table tr {
                margin: 0 7px 2em 0;
                box-shadow: 8px 8px 8px rgba(0,0,0,0.2);
                float: left;
                width: 100%;
            }

                #inkind-table tr:nth-child(odd) {
                    background: #ffffff;
                    border: 1px solid #ccc;
                    border-radius: 8px;
                }

                #inkind-table tr:nth-child(even) {
                    background: #f1f5f8;
                    border: 1px solid #ccc;
                    border-radius: 8px;
                }

            #inkind-table td {
                border: none;
                border-bottom: 1px solid #eee;
                position: relative;
                float: left;
                width: 100%;
            }

                #inkind-table td:before {
                    position: relative;
                    top: 10px;
                    left: 0;
                    width: 35%;
                    padding-right: 10px;
                    white-space: nowrap;
                    height: auto;
                    display: inline-block;
                    float: left;
                }

        .table-div {
            border: none !important;
        }



        #inkind-table td:before {
            content: attr(data-title);
            text-align: left;
            padding-top: 0.6em;
            margin-left: 1em;
        }

        #inkind-table > tbody > tr > td {
            text-align: right !important;
            margin-right: 2em;
        }

        #inkind-tbody tr td p {
            padding: 10px 10px 10px 10px;
            text-align: right;
            font-size: 14px;
            margin: 0;
            border-right: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            width: 55%;
            margin-right: 0;
            display: inline-block;
        }
    }

    @@media (min-width: 992px) and (max-width: 1199px) {
        .custom-modal .modal-dialog-ch {
            width: 96%;
        }

        .img-camera {
            margin-left: 15px;
        }
    }

    @@media (min-width: 768px) and (max-width: 991px) {
        .custom-modal .modal-dialog-ch {
            width: 98%;
            margin: 30px 0;
        }

        .img-camera {
            margin-left: 15px;
        }
    }

    @@media (max-width: 767px) {
        .custom-modal .modal-dialog-ch {
            width: 98%;
            margin: 30px 0;
        }

        .img-camera {
            margin-left: 15px;
        }

        .case-float {
            float: left;
        }
        /* Force table to not be like tables anymore */
        #no-more-tables6 table,
        #no-more-tables6 thead,
        #no-more-tables6 tbody,
        #no-more-tables6 th,
        #no-more-tables6 td,
        #no-more-tables6 tr {
            display: block;
            padding-left: 0;
            padding-right: 0;
        }

            /* Hide table headers (but not display: none;, for accessibility) */
            #no-more-tables6 thead tr {
                position: absolute;
                top: -9999px;
                left: -9999px;
            }

        #no-more-tables6 tr { /* border: 1px solid #ccc; */
        }

        #no-more-tables6 td {
            /* Behave  like a "row" */
            border: none;
            border-bottom: 1px solid #eee;
            position: relative;
            padding-left: 46%;
            white-space: normal;
            text-align: left;
        }

            #no-more-tables6 td:before {
                /* Now like a table header */
                position: absolute;
                /* Top/left values mimic padding */
                top: 6px;
                left: 6px;
                width: 45%;
                padding-right: 10px;
                white-space: nowrap;
                text-align: left;
                font-weight: bold;
            }

            /*
        Label the data
        */
            #no-more-tables6 td:before {
                content: attr(data-title);
            }
    }


    @@media only screen and (max-width: 768px)
    {
        #divCaseNoteSection .form-group {
    padding: 0px;
}

        .camimgs 
        {
            float:left!important;
        }

        .attach-icon-div-gallery
        {
            opacity: 1!important;
        }
    }
</style>


@{ 

    var guid = Guid.NewGuid().ToString();
}

<div class="col-xs-12 col-lg-12 no-padding new-casenote max_items_addn caseNoteSection_@guid" id="divCaseNoteSection" data-current-id="@guid">


    <h3 class="addapplicant" style="padding:0;padding-bottom:5px;">
        <i class="fa fa-book" aria-hidden="true"></i><span id="heading_case_note">&nbsp;Case Note</span>

        <a class="export-new" href="/Reporting/ExportCaseNote?caseNoteId=@(string.IsNullOrEmpty(Model.CaseNote.CaseNoteid)?"0": Model.CaseNote.CaseNoteid)&clientId=@(string.IsNullOrEmpty(Model.CaseNote.ClientId)?"0":Model.CaseNote.ClientId)&householdId=@(string.IsNullOrEmpty(Model.CaseNote.HouseHoldId)?"0":Model.CaseNote.HouseHoldId)" style="text-decoration:none;float: right;" data-toggle="tooltip" title="Export to PDF">
            <img src="/Images/export.svg" style="height:25px;width:25px;">
        </a>

    </h3>
   

    @Html.Hidden("hidden_centerId_"+guid, (Model != null ? Model.CenterID : "0"))
    @Html.Hidden("hidden_classroomId_"+guid, (Model != null ? Model.ClassroomID : "0"))
    @Html.Hidden("hidden_householdId_"+guid, (Model != null ? Model.Enc_HouseholdID : "0"))
    @Html.Hidden("hidden_programId_"+guid, (Model != null ? Model.ProgramId : "0"))
    @Html.Hidden("hidden_clientId_"+guid, (Model != null ? Model.Enc_ClientID : "0"))




    <div class="col-xs-12">




        <div class="form-group col-xs-12">



            @if (Model!=null && Model.CaseNote!=null && Model.CaseNote.CaseNoteid != null && Model.CaseNote.CaseNoteid != "" && Model.CaseNote.CaseNoteid != "0")
            {

                <label for="txtCaseNoteDate_@guid" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Date</label>
                <label class="col-md-5 col-lg-9 col-xs-12" style="font-weight:normal;">@(string.Concat(!string.IsNullOrEmpty(Model.CaseNote.CaseNoteDate) ? Convert.ToDateTime(Model.CaseNote.CaseNoteDate, new System.Globalization.CultureInfo("en-US", true)).ToString("MMMM dd, yyyy") : string.Empty, " ")) <i style="color:red;">(Written on, @Model.CaseNote.ActualWrittenDateTime)</i> </label>
                <input type="hidden" id="hdn-casenoteid_@guid" value="@Model.CaseNote.CaseNoteid">
                <input type="text" id="txtCaseNoteDate_@guid" style="display:none;" disabled name="CaseNoteDate" class="form-control" onblur="checkCaseNoteDate(this);" value="@(Model!=null && Model.CaseNote!=null ?Model.CaseNote.CaseNoteDate:string.Empty)" placeholder="MM/DD/YYYY">
            }
            else
            {
                <label for="txtCaseNoteDate_@guid" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Date&nbsp;<sup style="color:red;">*</sup></label>

                <div class="col-md-5 col-lg-9 col-xs-12">
                    <input type="text" id="txtCaseNoteDate_@guid" disabled name="CaseNoteDate" class="form-control" onblur="checkCaseNoteDate(this);" value="@(Model!=null && Model.CaseNote!=null ?Model.CaseNote.CaseNoteDate:string.Empty)" placeholder="MM/DD/YYYY">
                    <input type="hidden" id="hdn-casenoteid_@guid" value="@Model.CaseNote.CaseNoteid">
                </div>
            }
        </div>

        <div class="form-group col-xs-12">


            @if (Model!=null && Model.CaseNote!=null && Model.CaseNote.CaseNoteid != null && Model.CaseNote.CaseNoteid != "" && Model.CaseNote.CaseNoteid != "0")
            {
                <label for="txtCaseNoteTitle_@guid" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Title</label>
                <label class="col-md-5 col-lg-9 col-xs-12" style="font-weight:normal;">@Model.CaseNote.Title</label>

                <input type="text" disabled style="display:none;" class="form-control" id="txtCaseNoteTitle_@guid" name="CaseNoteTitle" value="@Model.CaseNote.Title" placeholder="Case Note Title">

            }
            else
            {
                <label for="txtCaseNoteTitle_@guid" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Title&nbsp;<sup style="color:red;">*</sup></label>

                <div class="col-md-5 col-lg-9 col-xs-12">
                    <input type="text" class="form-control" id="txtCaseNoteTitle_@guid" name="CaseNoteTitle" value="@Model.CaseNote.Title" placeholder="Case Note Title">
                </div>
            }




        </div>




        <div class="form-group col-xs-12" @if (Model!=null && Model.CaseNote!=null && Model.CaseNote.CaseNoteid != null && Model.CaseNote.CaseNoteid != "" && Model.CaseNote.CaseNoteid != "0") { <text> style="display:none;" </text>    }>


            <label for="txtareaCaseNote_@guid" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Note&nbsp;<sup style="color:red;">*</sup></label>

            <div class="col-md-5 col-lg-9 col-xs-12">
                <textarea id="txtareaCaseNote_@guid" name="Note" style="visibility: hidden; display: none;">


                    @Model.CaseNote.Note

                </textarea>
                <input type="hidden" name="Note" id="Note_@guid" />


            </div>

        </div>

        @if (Model.CaseNote.CaseNoteid != null && Model.CaseNote.CaseNoteid != "" && Model.CaseNote.CaseNoteid != "0")
        {
            <div class="form-group col-xs-12">
                <label for="mainCasenotes" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Original Note</label>

                <div id="mainCasenotes" class="txt-main-note col-md-5 col-lg-9 col-xs-12" style="line-height:1.3;padding:0;background-color:yellow;">
                    @Html.Raw(Model.CaseNote.Note)
                </div>

            </div>
        }



        @if (Model != null && Model.CaseNote != null && Model.CaseNote.CaseNoteid != null && Model.CaseNote.CaseNoteid != "" && Model.CaseNote.CaseNoteid != "0")
        {
            <div class="form-group col-xs-12 divAppendedNotes">
                <label for="sub-notes-details" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Appended Notes</label>

                <div class="col-md-5 col-lg-9 col-xs-12 sub-notes-details">
                    @if (Model.CaseNote != null && Model.CaseNote.SubCaseNoteList != null && Model.CaseNote.SubCaseNoteList.Count > 0)
                    {

                        for (int i = 0; i < Model.CaseNote.SubCaseNoteList.Count; i++)
                        {




                            var subDate = DateTime.Parse( string.IsNullOrEmpty(Model.CaseNote.SubCaseNoteList[i].WrittenDate)?Model.CaseNote.SubCaseNoteList[i].ActualWrittenDateTime:Model.CaseNote.SubCaseNoteList[i].WrittenDate, new System.Globalization.CultureInfo("en-US", true));

                            var subDateString = subDate.ToString("MMMM dd, yyyy");



                            <div class="accordion">
                                <a href="javascript:void(0);">
                                    <h4> Posted on <span>@subDateString</span></h4>
                                </a>
                            </div>

                            <div class="addn-poup-div accordion-desc sub-text-block" style="display:none;">

                                <table class="table" style="outline:1px solid #ddd;">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <strong>Name of the Staff, Role</strong>

                                            </td>
                                            <td>@Model.CaseNote.SubCaseNoteList[i].WrittenBy, @Model.CaseNote.SubCaseNoteList[i].RoleOfOwner</td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>Note</strong>
                                            </td>
                                            <td style="background-color:yellow;">@(Html.Raw(Model.CaseNote.SubCaseNoteList[i].Notes))</td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>Tags</strong>
                                            </td>
                                            <td>

                                                @if (Model.CaseNote.SubCaseNoteList[i].TagList != null && Model.CaseNote.SubCaseNoteList[i].TagList.Count > 0)
                                                {
                                                    for (int j = 0; j < Model.CaseNote.SubCaseNoteList[i].TagList.Count; j++)
                                                    {

                                                        if (Model.CaseNote.SubCaseNoteList[i].TagList[j].Text != "")
                                                        {
                                                            <span id="subTags" class="tag-text">@Model.CaseNote.SubCaseNoteList[i].TagList[j].Text</span>

                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    <span>No tags available</span>

                                                }
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>Attachments</strong>
                                            </td>

                                            <td>
                                                @if (Model.CaseNote.SubCaseNoteList[i].Attachment != null && Model.CaseNote.SubCaseNoteList[i].Attachment.Count > 0)
                                                {

                                                    for (int k = 0; k < Model.CaseNote.SubCaseNoteList[i].Attachment.Count; k++)

                                                    {
                                                        <a title='Click here to download' href='/Agencyuser/getpdfimage1/@Model.CaseNote.SubCaseNoteList[i].Attachment[k],CaseNote,0'><i class='fa fa-download'></i></a>
                                                        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>



                                                    }
                                                }

                                            </td>
                                        </tr>



                                    </tbody>

                                </table>
                            </div>



                        }
                    }
                    else
                    {
                        <div class="addn-poup-div col-xs-12 no-padding">
                            <h4 style="margin-top:0;">N/A</h4>
                        </div>
                    }
                </div>
            </div>
        }



        <div class="form-group col-xs-12">
            <label for="txtCaseNoteTags_@guid" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Tags&nbsp;<sup style="color:red;">*</sup></label>

            <div class="col-md-5 col-lg-9 col-xs-12">
                @{

                    string tagNames = "";

                    if (Model.CaseNote.TagList != null && Model.CaseNote.TagList.Count > 0)
                    {
                        var textList = Model.CaseNote.TagList.Where(x => x.Text != null && x.Text.Trim() != string.Empty).Select(x => x.Text).ToArray();
                        tagNames = string.Join(",", textList);
                    }

                }

                <input type="text" id="txtCaseNoteTags_@guid" name="CaseNotetags" value="" style="display: none;">
                <input type="hidden" id="tempTagname_@guid" value="@tagNames" />


            </div>

        </div>



        <div class="form-group col-xs-12">
            <label for="" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Clients&nbsp;<sup style="color:red;">*</sup></label>

            <div class="col-md-5 col-lg-9 col-xs-12" id="divCaseNoteClients_@guid">
                @if (Model != null && Model.CaseNote.ClientList != null && Model.CaseNote.ClientList.Count > 0)
                {
                    int i = 0;
                    foreach (var child in Model.CaseNote.ClientList)
                    {

                        <div class="fa-checkbox all-notes-check">

                            @if (child.Selected)
                            {
                                <input type="checkbox" checked="checked" id="@string.Concat("check_",i,"_",guid)" name="ClientIds.IDS" value="@child.Value" style="display:none;" class="allnotesChk">

                            }
                            else
                            {
                                <input type="checkbox" id="@string.Concat("check_",i,"_",guid)" name="ClientIds.IDS" value="@child.Value" style="display:none;" class="allnotesChk">
                            }
                            <label for="@string.Concat("check_",i,"_",guid)" style="font-weight:normal;">@child.Text</label>

                        </div>


                        i++;


                    }
                }

            </div>

        </div>

        <div class="form-group col-xs-12">
            <label for="" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Developmental Team</label>

            <div class="col-md-5 col-lg-9 col-xs-12" id="divCaseNoteStaffs_@guid">
                @if (Model != null && Model.CaseNote.StaffList != null && Model.CaseNote.StaffList.Count > 0)
            {
                int i = 0;
                foreach (var staff in Model.CaseNote.StaffList)
                {
                        <div>

                            <div class="fa-checkbox all-notes-check">

                                @if (staff.Selected)
                                {
                                    <input type="checkbox" checked="checked" id="@string.Concat("teamId_",i,"_",guid)" name="TeamIds.IDS" value="@staff.Value" style="display:none;" class="allnotesChk">

                                }
                                else
                                {
                                    <input type="checkbox" id="@string.Concat("teamId_",i,"_",guid)" name="TeamIds.IDS" value="@staff.Value" style="display:none;" class="allnotesChk">

                                }

                                <label for="@string.Concat("teamId_",i,"_",guid)" name="@string.Concat("teamId_",i,"_",guid)" style="font-weight:normal;">@staff.Text</label>
                            </div>



                        </div>

                        i++;
                    }
                }
            </div>

        </div>

        <div class="form-group col-xs-12">
            <label for="" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >Secure Note Level ?</label>

            <div class="col-md-5 col-lg-9 col-xs-12">



                <div class="fa-checkbox all-notes-check">
                    @if (Model.CaseNote.SecurityLevel)
                    {
                        <input type="checkbox" checked="checked" id="checkboxSecureNote_@guid" name="CaseNoteSecurity" style="display:none;" value="true" class="allnotesChk">

                    }
                    else
                    {
                        <input type="checkbox" id="checkboxSecureNote_@guid" name="CaseNoteSecurity" style="display:none;" value="true" class="allnotesChk">

                    }

                    <label for="checkboxSecureNote_@guid" style="font-weight:normal;">Yes</label>
                </div>
            </div>




        </div>








        <div class="form-group col-xs-12" id="caseNoteAttachmentsDiv_@guid">
            <label for="" class="col-md-4 col-lg-3 col-xs-12 lbl-text" >
                Attachment <small style="padding:0;color:red;">(.pdf,.jpg,.jpeg,.bmp,.gif,.png)</small>
            </label>

            <div class="col-lg-9 col-xs-12">
                <div class="col-xs-7 col-sm-9 col-lg-9 no-padding">
                    <input type="file" id="FirstFile" name="CaseNoteAttachmentList[0].file" @*name="Attachments[0].file"*@ class="form-control">
                </div>
                <div class="col-xs-5 col-sm-3 col-lg-3 adddivspace response-addicspace" style="top: 0px;">

                    <a href="javascript:void(0)" id="Attachmectstag" title="Add Attachment" onclick="AddMore(this);"><i class="fa fa-plus-circle"></i>&nbsp;Add</a>
                    <img id="uploadImageCamera" class="img-camera" data-guid="@guid" src="/Images/camera.png" style="margin-left: 25px; display: inline;"  />

                </div>
            </div>

            <div class="col-lg-9 col-sm-12" id="addAttachmentDiv_@guid">


            </div>

            <div class="col-lg-9 col-sm-12 adddivspace pull-right camimgs div-edit-gallery_@guid" id="div-edit-modal-img-gallery"></div>

        </div>

        @if (Model != null && Model.CaseNote != null && Model.CaseNote.CaseNoteid != null && Model.CaseNote.CaseNoteid != "" && Model.CaseNote.CaseNoteid != "0")
        {
            <div class="form-group col-xs-12" id="div_download_attach_@guid">
                <label for="" class="col-md-4 col-lg-3 col-xs-12 lbl-text">Download Attachment(s)</label>

                <div class="col-md-5 col-lg-9 col-xs-12" id="div_attach_download_bind_section_@guid">

                    @if (Model.CaseNote.CaseNoteAttachmentList != null && Model.CaseNote.CaseNoteAttachmentList.Count > 0)
                    {

                        foreach (var attachment in Model.CaseNote.CaseNoteAttachmentList)
                        {
                            <a title='Click here to download' style='font-size:18px;' href='/Agencyuser/getpdfimage1/@attachment.AttachmentId,CaseNote,0'><i class='fa fa-download'></i></a>
                            <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>
                        }
                    }
                    else
                    {
                        <label style="font-weight:normal;">N/A</label>
                    }

                </div>

            </div>

        }



        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="btnwrp_subcal">
                <button type="button" class="save-casenote save_casenote_@guid glossy-button-button button-green" onclick="return validateCaseNote(this);">
                    Submit

                    <span class="glossy-button-before"></span>
                    <span class="glossy-button-after"></span>

                </button>
                &nbsp;&nbsp;
                <button tabindex="17" class="cancel-casenote glossy-button-button button-red" data-dismiss="modal" type="button">
                    Cancel
                    <span class="glossy-button-before"></span>
                    <span class="glossy-button-after"></span>
                </button>
            </div>
        </div>

    </div>

</div>


<script>




    var count = 1;


    function AddMore(ele) {
       

        var currentsectionId = $(ele).closest('#divCaseNoteSection').attr('data-current-id');

        var appendDiv = '<div class="col-xs-12 no-padding attachment_' + count + '" style="padding-top:10px;">\
                <div class="col-sm-9 col-lg-9 col-xs-7 no-padding">\
                    <input type="file" name="CaseNoteAttachmentList[' + count + '].file"  class="form-control">\
                </div>\
                <div class="col-sm-3 col-lg-3 col-xs-4 adddivspace response-addicspace">\
                    <a href="javascript:void(0)" title="Remove Attachment" onclick="RemoveAttach(this,' + count + ');">\
                        <i class="fa fa-minus-circle"></i>&nbsp;Remove\
                    </a>\
                </div>\
            </div>';




        $(ele).closest('#caseNoteAttachmentsDiv_'+currentsectionId+'').find('#addAttachmentDiv_'+currentsectionId+'').append(appendDiv);


        count++;
    }


    function RemoveAttach(_ele, count) {

        $(_ele).closest('.attachment_' + count + '').remove();


    }

    function checkCaseNoteDate(value) {
        isValid = true;
        if (!$(value).attr("readonly")) {

            if ($(value).val().trim() != "MM/DD/YYYY" && $(value).val().trim() != "") {
                var dateformat = /^(0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])[\/\-]\d{4}$/;
                var regex = new RegExp(dateformat);
                if (!regex.test($(value).val())) {
                    customAlert("Invalid date format. ");
                    $(value).val('');
                    return false;
                }
                else {
                    var text = $(value).val();
                    var comp = text.split('/');
                    var m = parseInt(comp[0], 10);
                    var d = parseInt(comp[1], 10);
                    var y = parseInt(comp[2], 10);
                    var date = new Date(y, m - 1, d);
                    if (date.getFullYear() == y && date.getMonth() + 1 == m && date.getDate() == d) {

                    } else {
                        customAlert("Invalid date. ");
                        $(value).val('');
                        return false;
                    }



                }
            }
            var txtdate = $(value).val();
            var selectedTimestampequal = new Date();
            var year = selectedTimestampequal.getFullYear();
            var month = selectedTimestampequal.getMonth() + 1;
            var day = selectedTimestampequal.getDate();
            today1 = month + '/' + day + '/' + year;
            var newinput = today1.split("/");
            var newday = newinput[1];
            var str = newday.substr(0, 1);
            var newdaynew = ('0' + newday).slice(-2);
            var newmonth = newinput[0];
            var str1 = newmonth.substr(0, 1);
            var newmonthnew = ('0' + newmonth).slice(-2);
            today = newmonthnew + '/' + newdaynew + '/' + year;
            if (today == txtdate) {
                return true;
            }
            var testdatelocalinput = new Date(txtdate);
            var selectedTimestamp = new Date().getTime();
            var testdatelocalinputTS = testdatelocalinput.getTime();
            var timestamp = new Date().getTime() - (30 * 24 * 60 * 60 * 1000)
            if (testdatelocalinputTS > selectedTimestamp) {
                customAlert("Case Note date must be less than or equal to today's date.");
                $(value).val('');
                return false;
            }
            else if (timestamp > testdatelocalinputTS) {
                customAlert("Case Note date cannot be less than 30 days from today's date.");
                $(value).val('');
                return false;
            }
        }
        return true;
    }



    $(function () {
        debugger;

        $('[data-toggle="tooltip"]').tooltip();

        var currentSectionId='@guid';

        if (CKEDITOR.instances['txtareaCaseNote_' + currentSectionId + '']) {
            CKEDITOR.remove(CKEDITOR.instances['txtareaCaseNote_' + currentSectionId + '']);
        }


        CKEDITOR.replace('txtareaCaseNote_'+currentSectionId+'', {
            language: 'en-gb',
            uiColor: '#295b8f',
            disableNativeSpellChecker: false
        });






        $('#txtCaseNoteDate_'+currentSectionId+'').mask("99/99/9999", { placeholder: 'MM/DD/YYYY' });



        $('#txtCaseNoteTags_'+currentSectionId+'_tag_autosize_tester').remove();


        var divSection='.caseNoteSection_'+currentSectionId+'';
        $('#txtCaseNoteTags_'+currentSectionId+'').tagsInput({
            width: 'auto',
            height: 'auto',
            delimiter: [',', ';'],
            autocomplete_url: '/Roster/GetCaseNoteTag',
            autocomplete: {
                'appendTo': divSection
            },
            refresh: true

        });



        //}



        debugger;






        var tags = [];



        if ($('#tempTagname_'+currentSectionId+'').val() != undefined && $('#tempTagname_'+currentSectionId+'') != null && $('#tempTagname_'+currentSectionId+'') != "") {

            $.each($('#tempTagname_'+currentSectionId+'').val().split(','), function (i, obj) {
                //$('#txtCaseNoteTags').addTag(obj);
                tags.push(obj);
            });

            $('#txtCaseNoteTags_'+currentSectionId+'').importTags(tags.join(',,;'));
        }




        $(document).on('change', '#caseNoteAttachmentsDiv_'+currentSectionId+' input:file', function (evt) {
           
            if (ValidateSingleInputpdf2(evt.target, null)) {
                encodeImagetoBase64(evt);

            }



        });

    });





</script>