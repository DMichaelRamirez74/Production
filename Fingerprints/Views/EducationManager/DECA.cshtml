@*@model FingerprintsModel.ParentInfoModel*@

@{
    ViewBag.Title = "ScreeningAnalysisInfo";
    Layout =  "~/Views/Shared/AgencyStaffLayout.cshtml";
}

@section Title{
    DECA Analysis
    
    }


@section MainContentHolder{
   @* <link href="~/Content/css/parentcontact.css" rel="stylesheet" />*@
    @*<link href="~/Content/css/jquery.mCustomScrollbar.min.css" rel="stylesheet" />*@
    <script src="~/Scripts/ClientFileReview/jquery.mCustomScrollbar.min.js"></script>

    <style>
        #page-wrapper {
            padding-left: 0;
            padding-right: 0;
        }


        .right-side-container-ch {
    width: 100%;
    float: left;
    background: url(../../Images/body-bg.jpg) center no-repeat;
    background-size: cover;
    min-height: 600px;
    padding-top:30px;
}

        .no-padding {
    padding: 0;
}

        .ersea-detl-title {
    margin-top: 15px;
    margin-bottom: 25px;
}

        .ersea-detl-title h2 {
    text-align: center;
    font-weight: bold;
    color: #fff;
}
        .ersea_ovr {
    text-align: center;
    width: 275px;
    margin: auto;
}

        .ersa-search-btn {
    display: inline-block;
    width: auto;
    vertical-align: bottom;
    top: 0;
    position: relative;
    z-index: 99;
}
        .ersa-select {
    /* width: 220px; */
    width: 245px;
    /* font-size: 19px; */
    font-size: 14px;
    color: #fff;
    display: inline-block;
    padding: 5px;
    resize: none;
    background: transparent;
    height: 40px;
    margin-right: 10px;
    border: 1px solid #fff!important;
    border-radius: 4px;
    position: relative;
    line-height: 40px;
}
        .ersa-search-btn a {
    font-size: 18px;
    text-transform: capitalize;
    text-align: center;
    display: inline-block;
    background: #f9c751;
    color: #212121;
    margin: 0;
    border-radius: 4px;
    width: 100px;
    padding: 7px 9px;
    margin: auto;
    font-weight: bold;
    line-height: 20px;
}

        select option {
            background: #164273;
        }

        .scroll-thead th {
            border: 1px solid #f1f5f8;
        }

        .scroll-thead {
            display: table;
            width: 100%;
            table-layout: fixed;
            width: 98.3%;
        }

        .scroll-tbody tr td, .scroll-tbody1 tr td {
            word-break: break-word;
        }

        .scroll-tbody {
            display: block;
            height: 250px;
            overflow: auto;
            overflow-x: hidden;
        }

            .scroll-tbody tr {
                display: table;
                width: 100%;
                table-layout: fixed;
            }

        .scroll-tbody1 {
            display: block;
        }

            .scroll-tbody1 tr {
                display: table;
                width: 100%;
                table-layout: fixed;
            }

        /*on-hover Assessment Group Text*/

        .childName .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: black;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 1;
            /*top: 28px;*/
            left: 128px;
            line-height: 25px;
        }

            /*.childName .tooltiptext::after {
            content: "";
            position: absolute;
            bottom: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: transparent transparent black transparent;
        }*/
            .childName .tooltiptext::after {
                content: " ";
                position: absolute;
                top: 50%;
                right: 100%; /* To the left of the tooltip */
                margin-top: -5px;
                border-width: 5px;
                border-style: solid;
                border-color: transparent black transparent transparent;
            }

        .childName:hover .tooltiptext {
            visibility: visible;
        }

        .ersea-table thead tr th, .ersea-table-head p {
            font-size: 14px;
        }

        .row-phone {
            line-height: 30px;
        }

        .phone-table {
            width: 100%;
        }

            .phone-table tr td {
                background: #fff !important;
                border: solid 1px #e7e7e7;
                padding: 5px;
            }

        .call-btn {
            width: 100%;
            border: none;
            padding: 5px 0;
            margin-bottom: 5px;
            font-size: 12px;
            color: #fff;
        }


        .child-row:nth-child(even) td, .child-row:nth-child(even) td p {
            background: #ccc0 !important;
        }

        .child-row:nth-child(odd) td, .child-row:nth-child(odd) p {
            background: #FFF !important;
        }

        /*.tooltip {
            position: absolute;
            background-color: #eeeefe;
            border: 1px solid #aaaaca;
            font-size: smaller;
            padding: 4px;
            width: 160px;
            box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
            -moz-box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
            -webkit-box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.1);
        }*/



        [tooltip]:before {
            /* needed - do not touch */
            content: attr(tooltip);
            position: absolute;
            opacity: 0;
            /* customizable */
            transition: all 0.15s ease;
            padding: 10px;
            color: #333;
            border-radius: 10px;
            box-shadow: 2px 2px 1px silver;
        }

        [tooltip]:hover:before {
            /* needed - do not touch */
            opacity: 1;
            /* customizable */
            background: yellow;
            margin-top: -50px;
            margin-left: 20px;
        }

        [tooltip]:not([tooltip-persistent]):before {
            pointer-events: none;
        }


       #GridRoster thead.table-hd.scroll-thead {
    background: #9B58B4!important;
    color: #fff;
}

       /*.table-striped > tbody > tr:nth-of-type(odd) {
    background-color: #f9f9f9;
}*/

       #GridRoster tbody tr td {
    border: solid 1px #e7e7e7;
}


       /*Responsive Section*/

         @@media only screen and (max-width: 760px), (min-device-width: 761px) and (max-device-width: 1200px) {

            /* Force table to not be like tables anymore */
            #GridRoster, #GridRoster thead, #GridRoster tbody, #GridRoster th, #GridRoster td, #GridRoster tr {
                display: block;
                border: none;
            }



                #GridRoster tbody tr td:first-child a {
                    width: initial !important;
                    text-overflow: initial !important;
                }

                /* Hide table headers (but not display: none;, for accessibility) */

                #GridRoster thead tr {
                    position: absolute;
                    top: -9999px;
                    left: -9999px;
                }

                #GridRoster tr {
                    margin: 0 7px 2em 0;
                    box-shadow: 8px 8px 8px rgba(0,0,0,0.2);
                }

                    #GridRoster tr:nth-child(odd) {
                        background: #ffffff;
                        border: 1px solid #ccc;
                        border-radius: 8px;
                    }


                    #GridRoster tr:nth-child(even) {
                        background: #f1f5f8;
                        border: 1px solid #ccc;
                        border-radius: 8px;
                    }

                #GridRoster td {
                    /* Behave  like a "row" */
                    border: none;
                    border-bottom: 1px solid #eee;
                    position: relative;
                    /*padding-left: 50%;*/
                }

                    #GridRoster td:before {
                        /* Now like a table header */
                        position: absolute;
                        /* Top/left values mimic padding */
                        top: 0;
                        left: 6px;
                        width: 45%;
                        padding-right: 10px;
                        white-space: nowrap;
                    }

            .table-div {
                border: none !important;
            }

            /*
                        Label the data
                    You could also use a data-* attribute and content for this. That way "bloats" the HTML, this way means you need to keep HTML and CSS in sync. Lea Verou has a clever way to handle with text-shadow.
                        */
            /*td:nth-of-type(1):before { content: "Center Name"; }
                        td:nth-of-type(2):before { content: "% Full"; }
                        td:nth-of-type(3):before { content: "Open Seats"; }
                        td:nth-of-type(4):before { content: "HV's"; }
                        td:nth-of-type(5):before { content: "Wait1"; }
                        td:nth-of-type(6):before { content: "Wait2"; }
                        td:nth-of-type(7):before { content: "Wait3"; }
                        td:nth-of-type(8):before { content: "T-Waiting"; }
                        td:nth-of-type(9):before { content: "F-Waiting"; }
                        td:nth-of-type(10):before { content: "Pending"; }
                        td:nth-of-type(11):before { content: "Accepted"; }
                        td:nth-of-type(12):before { content: "Returned"; }*/

            #GridRoster td:before {
                content: attr(data-title);
                text-align: left;
                padding-top: 0.6em;
                margin-left: 1em;
            }

            #GridRoster td a, #GridRoster td i {
                margin-top: 1em;
            }



            #GridRoster > tbody > tr > td {
                text-align: right !important;
                padding-right: 2em;
            }

            .table-responsive {
                border: none !important;
            }

        /*new changes*/

        .scroll-tbody{
            height:auto!important;
            overflow:unset;
            
        }

        #GridRoster tbody tr td p.client-name,#GridRoster tbody tr td p.parent-name {
            text-align:right!important;
        }
        
        #GridRoster{
            margin-top:30px;
        }

        .menu-change-width>div
        {
            margin-bottom:15px;
        }

        }


         @@media only screen and  (max-device-width:1280px) and (min-device-width:1200px)
         {
             .ersa-select{
                 width:220px;
             }
         }
  /*Responsive Section*/


    </style>

     <div class="container-fluid">
        <div class="row">
            <div class="right-side-container-ch">

                <div class="col-xs-12" style="padding:0px 15px;margin-bottom:20px;">
                    <div class="col-lg-12">
                        <h2 class="page-header page-header-change" style="border-bottom:5px solid #f9c751!important;color:#fff;">
                            <i class="fa fa-stethoscope" aria-hidden="true"></i> DECA Analysis

                            <span class="view-btn backto_listspan">
                                <a href="/EducationManager/EducationManagerDashboard" style="padding:10px;float: right;color: #fff;margin-right:0px;background-color:#9b59b6;border-radius: 4px;text-decoration:none;" class="backto_list">Back to Dashboard</a>

                            </span>
                        </h2>
                    </div>


                </div>

                <div class="col-xs-12 no-padding">
                    <div class="col-xs-12 no-padding">
                        @*<div class="col-xs-12 ersea-detl-title">
                            <h2>DECA Analysis</h2>
                            <div class="ersea_ovr"><img src="~/images/text-bdr.png" class="img-responsive"></div>
                        </div>*@
                        <div class="col-xs-12 menu-change-width">
                            <div class="col-lg-3 col-sm-6">


                                @Html.DropDownList("ddlCenterDetails", Fingerprints.Utilities.Helper.GetCentersByUserId(Session["UserId"].ToString(), Session["AgencyID"].ToString(), Session["RoleID"].ToString()), new { @class = "ersa-select center-select width-select-change" })



                            </div>
                            <div class="col-lg-3 col-sm-6">
                                <select class="ersa-select select-classroom width-select-change" id="classroomSelect">
                                    <option value="0">--Select Classroom--</option>
                                </select>
                            </div>
                            <div class="col-lg-3 col-sm-6">
                                <select class="ersa-select select-filter width-select-change">
                                    <option value="0">--Filter Type--</option>
                                    <option value="1">Re-screen</option>
                                  
                                </select>

                            </div>
                            <div class="col-lg-3 col-sm-6 ersa-search-btn">
                                <a href="javascript:void(0);" id="searchByfilter" style="padding: 10px 9px;">Search</a>
                            </div>
                        </div>


                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 table-main">
                            <div class="col-xs-12" style="border-radius: 10px;background: #f1f5f8;padding: 10px;width: 98%;margin:20px 1%;">


                                <div class="col-xs-12 text-left">
                                    <label style="color:#1d5381;">Total Count : <span id="totalCountSpan">0</span></label>

                                </div>


                                <table class="table table-striped table-condensed" id="GridRoster" role="table">
                                    <thead class="table-hd scroll-thead" role="rowgroup">
                                        <tr role="row">
                                            <th role="columnheader">Client</th>
                                            <th role="columnheader">DOB</th>
                                            <th role="columnheader">Center </th>
                                            <th role="columnheader">Classroom</th>
                                            <th role="columnheader">Initial Parent DECA Date</th>
                                            <th role="columnheader">Completed By</th>
                                            <th role="columnheader">Relation to Child</th>
                                            <th role="columnheader">Areas of Need</th>
                                            <th role="columnheader">Initial Teacher / Home Visitor DECA Date</th>
                                            <th role="columnheader">Completed By (Staff)</th>
                                            <th role="columnheader">Areas of Need (Staff)</th>
                                            <th role="columnheader">Mental Health Referral Date</th>
                                            <th role="columnheader">Referral Based On</th>
                                        </tr>
                                    </thead>
                                    <tbody class="ersea-table-head bind_body scroll-tbody" role="rowgroup">
                  


                                        <tr style="width:98.3%">
                                            <td style="padding: 25px;text-align:center;font-weight:bold;">Search by Center and Classroom<sup style="color:red;">*</sup></td>
                                        </tr>




                                        
                                     

                                    </tbody>



                                </table>


                            </div>
                        </div>




                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-----Div Cal Table-->




    <script>
        $(function () {
            var centerIdSelect = $('.center-select');
            var classRoomIdSelect = $('.select-classroom');
            var filterTypeSelect = $('.select-filter');
            var searchText = $('#searchText');



            //if ($('.scroll-tbody').children('.child-row').length <= 2) {
            //    $('.scroll-tbody').children('.child-row').each(function (i, row) {
            //        $(row).css({ 'width': '98.3%' });
            //    });
            //}
            //else if ($('.scroll-tbody').children('.child-row').length > 2) {
            //    $('.scroll-tbody').children('.child-row').each(function (i, row) {
            //        $(row).css({ 'width': '100%' });
            //    });
            //}

            $(window).bind("load resize", function () {

                topOffset = 50;
                width = (this.window.innerWidth > 0) ? this.window.innerWidth : this.screen.width;
                if (width < 768) {
                    topOffset = 100; // 2-row-menu
                }

                height = ((this.window.innerHeight > 0) ? this.window.innerHeight : this.screen.height) - 1;

                height = height - topOffset;
                if (height < 1) height = 1;
                if (height > topOffset) {
                    var fileHeight = height - 25;

                    $('.right-side-container-ch').css('min-height', (fileHeight - 5) + 'px');
                    $('.scroll-tbody').height(fileHeight - 317);
                }

                //reSizeContent();
            });



            function getListByFilter() {
               
                $('#spinner').show();
                $.ajax({
                    url: '/EducationManager/GetScreeningInfoDeca',
                    datatype: 'json',
                    type: 'post',
                    contentType: "application/json;",
                    data:JSON.stringify({ centerId: parseInt(centerIdSelect.val()), classRoomId: parseInt(classRoomIdSelect.val()), filterType: parseInt(filterTypeSelect.val()) }),
                    success: function (data) {
                        
                        var appendData = '';
                        var totalCount = 0;
                        var noRecordTmp = '<tr style="width:98.3%"><td style="padding: 25px;text-align:center;">Records Not Found</td></tr>';
                        if (data != null) {
                            if (data.ScreeningAnalysisInfoList != null) {
                                if (data.ScreeningAnalysisInfoList.length > 0) {

                                    totalCount = (data.ScreeningAnalysisInfoList.length > 0 && data.ScreeningAnalysisInfoList.length < 10) ? '0' + data.ScreeningAnalysisInfoList.length : data.ScreeningAnalysisInfoList.length;

                                    $.each(data.ScreeningAnalysisInfoList, function (i, info) {

                                       
                                        appendData += '<tr role="row">\
                                                    <td data-title="Client" role="gridcell" wrap>\
                                                        <p class="client-name" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.ChildName + '"  style="text-align:center;" accesskey=' + info.ClientId + '>' + info.ChildName + '</p>\
                                                    </td>\
                                                    <td data-title="DOB" role="gridcell" wrap >\
                                                        <p class="parent-name" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.dob + '"  style="text-align:center;">' + info.dob + '</p>\
                                                    </td>\
                                                    <td data-title="Center" role="gridcell" wrap>\
                                                      <p>  <a class="center-name" href="#" title="'+ info.CenterName + '" accesskey=' + info.CenterId + ' >' + info.CenterName + '</a></p>\
                                                    </td>\
                                                    <td data-title="Classroom" role="gridcell" wrap>\
                                                       <p> <a class="classroom-name" href="#"  title="'+ info.ClassroomName + '" accesskey=' + info.ClassroomId + '>' + info.ClassroomName + '</a></p>\
                                                    </td>\
                                                    <td data-title="Initial Parent DECA Date" role="gridcell" wrap>\
                                                        <a class="email-id" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.InitialParentDecaDate + '"  style="text-align:center;">' + info.InitialParentDecaDate + '</a>\
                                                    </td>\
                                                     <td data-title="Completed By" role="gridcell" wrap>\
                                                        <a class="email-id" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.FamilyCompleted + '"  style="text-align:center;">' + info.FamilyCompleted + '</a>\
                                                    </td>\
                                                    <td data-title="Relation to Child" role="gridcell" wrap>\
                                                        <a class="email-id" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.Relationship + '"  style="text-align:center;">' + info.Relationship + '</a>\
                                                    </td>\
                                                    <td data-title="Areas of Need" role="gridcell" wrap>\
                                                        <a class="email-id" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.AreaofNeed1 + '"  style="text-align:center;">' + info.AreaofNeed1 + '</a>\
                                                    </td>\
                                                     <td data-title="Initial Teacher/Home Visitor DECA Date" role="gridcell"  wrap>\
                                                        <a class="email-id" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.InitialStaffDecaDate + '"  style="text-align:center;">' + info.InitialStaffDecaDate + '</a>\
                                                    </td>\
                                                    <td data-title="Completed By (Staff)" role="gridcell" wrap>\
                                                        <a class="email-id" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.StaffCompleted + '"  style="text-align:center;">' + info.StaffCompleted + '</a>\
                                                    </td>\
                                                    <td data-title="Areas on Need (Staff)" role="gridcell" wrap>\
                                                        <a class="email-id" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.AreaofNeed2 + '"  style="text-align:center;">' + info.AreaofNeed2 + '</a>\
                                                    </td>\
                                                     <td data-title="Mental Health Referral Date" role="gridcell" wrap>\
                                                        <a class="email-id" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.MentalHealthDate + '"  style="text-align:center;">' + info.MentalHealthDate + '</a>\
                                                    </td>\
                                                    <td data-title="Referral Based on" role="gridcell" wrap>\
                                                        <a class="email-id" href="#" data-toggle="tooltip" data-placement="top"  title="' + info.ReferralBasedOn + '"  style="text-align:center;">' + info.ReferralBasedOn + '</a>\
                                                    </td>\
                                                     </tr>';

                                    });

                                    $('.scroll-tbody').html(appendData);


                                    if (document.documentMode || /Edge/.test(navigator.userAgent)) {

                                        if (data.ScreeningAnalysisInfoList.length <= 2) {
                                            //$('.scroll-tbody').children('.child-row').each(function (i, row) {
                                            //    $(row).css({ 'width': '98.3%' });
                                            //});
                                            $('.scroll-tbody').css({ 'width': '98.3%' });
                                        }
                                        else {
                                            //$('.scroll-tbody').children('.child-row').each(function (i, row) {
                                            //    $(row).css({ 'width': '100%' });
                                            //});
                                            $('.scroll-tbody').css({ 'width': '99.4%' });
                                        }

                                    }


                                    else if (data.ScreeningAnalysisInfoList.length <= 2) {
                                        //$('.scroll-tbody').children('.child-row').each(function (i, row) {
                                        //    $(row).css({ 'width': '98.3%' });
                                        //});
                                        $('.scroll-tbody').css({ 'width': '98.3%' });
                                    }
                                    else {
                                        //$('.scroll-tbody').children('.child-row').each(function (i, row) {
                                        //    $(row).css({ 'width': '100%' });
                                        //});
                                        $('.scroll-tbody').css({ 'width': '100%' });
                                    }
                                }
                                else {

                                    $('.scroll-tbody').html(noRecordTmp);

                                }

                            }
                            else {

                                $('.scroll-tbody').html(noRecordTmp);

                            }
                        }
                        else {

                            $('.scroll-tbody').html(noRecordTmp);

                        }
                        $('#totalCountSpan').text(totalCount);

                        $('#spinner').hide();
                    },
                    error: function (response) {
                        $('#spinner').hide();
                        console.log(response);
                        alert('error');

                    }

                })

            }

            $('.scroll-tbody').find('.phone-no-table').each(function (i, table) {
                $(table).find('td').each(function (j, td) {

                    var clas = $(td).attr('class');
                    var hgt = $(td).height();
                    $('.lbl_' + clas + '').height(hgt);
                });
            });

            $('.center-select').on('change', function () {

                var centerId = $(this).val();
                if (centerId == '0') {
                    $('.select-classroom').html('<option value="0">--Select Classroom--</option>');
                    $('.select-filter').val(0);
                    var searchRow = '<tr style="width:98.3%">\
                                            <td  style="padding: 25px;text-align:center;">Search by Center and Classroom<sup style="color:red;">*</sup></td>\
                                        </tr>';
                    $('.scroll-tbody').html(searchRow);
                }
                else {
                    $.ajax({
                        url: "/AgencyUser/GetClassByCenterID",
                        datatype: 'json',
                        type: 'post',
                        data: { CenterID: centerId },
                        success: function (data) {
                            if (data.length > 0) {
                                var classroom = '<option value="0">--Select Classroom--</option>';

                                if (data.length === 1) {
                                    classroom = '<option value=' + data[0].ClassRoomId + '>' + data[0].ClassRoomName + '</option>';
                                    $('.select-classroom').html(classroom);
                                }

                                else {
                                    $.each(data, function (i, element1) {
                                        classroom += '<option value=' + element1.ClassRoomId + '>' + element1.ClassRoomName + '</option>';
                                    });
                                    $('.select-classroom').html(classroom);
                                }
                                //if (data.length === 1) {
                                //    $('.select-classroom').val(data[0].ClassRoomId);
                                //}
                            }
                        },
                        error: function (data) {

                        }
                    });
                }
            });

            $('#searchByfilter').on('click', function () {

                cleanValidation();
                if ($('.center-select').val() === '0') {
                    plainValidation('#ddlCenterDetails');
                    customAlert('Please Select Center');
                    return false;
                }
              
                getListByFilter();

            });

            $('#searchByemailName').on('click', function () {

                getListByFilter();

            });

        });
    </script>




}
